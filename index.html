<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Calculate your one rep max for weightlifting exercises">
  <meta name="theme-color" content="#1e293b">
  <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIjFSTSBDYWxjdWxhdG9yIiwKICAic2hvcnRfbmFtZSI6ICIxUk0iLAogICJkZXNjcmlwdGlvbiI6ICJDYWxjdWxhdGUgeW91ciBvbmUgcmVwIG1heCBmb3Igd2VpZ2h0bGlmdGluZyBleGVyY2lzZXMiLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzFlMjkzYiIsCiAgInRoZW1lX2NvbG9yIjogIiMxZTI5M2IiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhPVElpSUdobGFXZG9kRDBpTVRreUlqNDhjbVZqZENCM2FXUjBhRDBpTVRreUlpQm9aV2xuYUhROUlqRTVNaUlnWm1sc2JEMGlJek15T1RWbE55SXZQanh3WVhSb0lHUTlJazB4TWpBZ05qQnNMVEl3SURJd2JDMHlNQ0F5TUd3eU1DMHlNR3d5TUNBeU1Hd3lNQ0F5TUd3eU1DMHlNR3d5TUMweU1Hd3RNakFnTWpCNklpQm1hV3hzUFNJamVtVjZPSE5yZUMxek5XeGhkR1V0Tnpnd0lpQnpkSEp2YTJVOUlpTXlOV000TldRaUlITjBjbTlyWlMxM2FXUjBhRDBpTWlJdlBqd3ZjM1puUGc9PSIsCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0kxTVRJaUlHaGxhV2RvZEQwaU5URXlJajQ4Y21WamRDQjNhV1IwYUQwaU5URXlJaUJvWldsbmFIUTlJalV4TWlJZ1ptbHNiRDBpSXpNeU9UVmxOeUl2UGp4d1lYUm9JR1E5SWsweU5UWWdNVFV3YkMwME1DQTBNR3d0TkRBZ05EQnNOREFnTkRCc05EQWdOREJzTkRBZ05EQnNOREFnTkRCc05EQXROREJzTkRBdE5EQjZJaUJtYVd4c1BTSWplbVY2T0hOcmVDMXpOV3hoZEdVdE56Z3dJaUJ6ZEhKdmEyVTlJaU15TldNNE5XUWlJSE4wY205clpTMTNhV1IwYUQwaU5DSXZQand2YzNablBnPT0iLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
  <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIj48cmVjdCB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgZmlsbD0iIzMyOTVlNyIvPjxwYXRoIGQ9Ik0xMjAgNjBsLTIwIDIwbC0yMCAyMGwyMCAyMGwyMCAyMGwyMCAyMGwyMC0yMGwyMC0yMGwtMjAtMjBsLTIwLTIweiIgZmlsbD0iI3plejhza3gtczVsYXRlLTc4MCIgc3Ryb2tlPSIjMjVjODVkIiBzdHJva2Utd2lkdGg9IjIiLz48L3N2Zz4=">
  <title>1RM Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    .install-prompt {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #3b82f6;
      color: white;
      padding: 12px 24px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      display: none;
      z-index: 1000;
      animation: slideUp 0.3s ease;
    }
    @keyframes slideUp {
      from { transform: translateX(-50%) translateY(100px); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }
    .install-prompt button {
      background: white;
      color: #3b82f6;
      border: none;
      padding: 8px 16px;
      border-radius: 8px;
      margin-left: 12px;
      cursor: pointer;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <div id="installPrompt" class="install-prompt">
    <span>Install this app on your device?</span>
    <button onclick="installApp()">Install</button>
    <button onclick="dismissInstall()" style="background: transparent; color: white;">Later</button>
  </div>

  <script>
    // Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        const swCode = `
          const CACHE_NAME = 'orm-calc-v1';
          const urlsToCache = ['/'];

          self.addEventListener('install', event => {
            event.waitUntil(
              caches.open(CACHE_NAME)
                .then(cache => cache.addAll(urlsToCache))
            );
          });

          self.addEventListener('fetch', event => {
            event.respondWith(
              caches.match(event.request)
                .then(response => response || fetch(event.request))
            );
          });
        `;
        
        const blob = new Blob([swCode], { type: 'application/javascript' });
        const swUrl = URL.createObjectURL(blob);
        
        navigator.serviceWorker.register(swUrl)
          .then(() => console.log('Service Worker registered'))
          .catch(err => console.log('Service Worker registration failed:', err));
      });
    }

    // Install Prompt
    let deferredPrompt;
    
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installPrompt').style.display = 'block';
    });

    function installApp() {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          document.getElementById('installPrompt').style.display = 'none';
          deferredPrompt = null;
        });
      }
    }

    function dismissInstall() {
      document.getElementById('installPrompt').style.display = 'none';
    }

    // App Logic
    const exercises = [
      'Bench Press', 'Squat', 'Deadlift', 'Overhead Press',
      'Barbell Row', 'Pull-ups', 'Dips', 'Other'
    ];

    let state = {
      exercise: '',
      reps: '',
      weight: '',
      oneRepMax: null
    };

    function render() {
      const app = document.getElementById('app');
      app.innerHTML = `
        <div class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4">
          <div class="bg-slate-800 rounded-2xl shadow-2xl p-8 w-full max-w-md border border-slate-700">
            <div class="flex items-center justify-center mb-6">
              <svg class="w-10 h-10 text-blue-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/>
              </svg>
              <h1 class="text-3xl font-bold text-white">1RM Calculator</h1>
            </div>

            <div class="space-y-5">
              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Exercise</label>
                <select id="exercise" class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
                  <option value="">Select an exercise</option>
                  ${exercises.map(ex => `<option value="${ex}" ${state.exercise === ex ? 'selected' : ''}>${ex}</option>`).join('')}
                </select>
              </div>

              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Reps Performed</label>
                <input type="number" id="reps" value="${state.reps}" placeholder="e.g., 5" min="1" max="12"
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>

              <div>
                <label class="block text-sm font-medium text-slate-300 mb-2">Weight Used (lbs/kg)</label>
                <input type="number" id="weight" value="${state.weight}" placeholder="e.g., 225" min="0" step="0.1"
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>

              <button onclick="calculate()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors duration-200">
                Calculate 1RM
              </button>

              ${state.oneRepMax ? `
                <div class="mt-6 p-6 bg-gradient-to-r from-blue-600 to-blue-700 rounded-xl text-center">
                  <p class="text-sm text-blue-100 mb-1">${state.exercise}</p>
                  <p class="text-4xl font-bold text-white mb-1">${state.oneRepMax}</p>
                  <p class="text-sm text-blue-100">Estimated 1 Rep Max</p>
                  <button onclick="reset()" class="mt-4 px-4 py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white rounded-lg text-sm transition-colors duration-200">
                    Calculate Another
                  </button>
                </div>
              ` : ''}
            </div>

            <p class="text-xs text-slate-400 mt-6 text-center">
              Using Epley Formula: 1RM = Weight Ã— (1 + Reps/30)
            </p>
          </div>
        </div>
      `;

      // Attach event listeners
      document.getElementById('exercise').addEventListener('change', (e) => {
        state.exercise = e.target.value;
      });
      document.getElementById('reps').addEventListener('input', (e) => {
        state.reps = e.target.value;
      });
      document.getElementById('weight').addEventListener('input', (e) => {
        state.weight = e.target.value;
      });
    }

    function calculate() {
      const r = parseFloat(state.reps);
      const w = parseFloat(state.weight);

      if (!state.exercise || !r || !w || r < 1 || r > 12) {
        alert('Please select an exercise and enter valid reps (1-12) and weight');
        return;
      }

      const calculated = w * (1 + r / 30);
      state.oneRepMax = calculated.toFixed(1);
      render();
    }

    function reset() {
      state = { exercise: '', reps: '', weight: '', oneRepMax: null };
      render();
    }

    render();
  </script>
</body>
</html>